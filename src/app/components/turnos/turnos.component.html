<div class="container mt-4">
  <!-- Título y Formulario -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <h3 class="card-title text-center mb-4">Historial de Turnos</h3>
      
      <form [formGroup]="filtroForm" (ngSubmit)="aplicarFiltros()">
        <div class="row g-3 align-items-end">
          <!-- Fecha de Inicio -->
          <div class="col-md-4">
            <label for="inicio" class="form-label">Desde</label>
            <input type="datetime-local" id="inicio" class="form-control" formControlName="inicio">
          </div>

          <!-- Fecha de Fin -->
          <div class="col-md-4">
            <label for="fin" class="form-label">Hasta</label>
            <input type="datetime-local" id="fin" class="form-control" formControlName="fin">
          </div>

          <!-- Botones -->
          <div class="col-md-4 d-flex gap-2">
            <button type="submit" class="btn btn-primary w-100">Filtrar</button>
            <button type="button" class="btn btn-outline-secondary w-100" (click)="limpiarFiltros()">Limpiar</button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- Tabla de Cierres -->
  <div class="card shadow-sm">
    <div class="card-header">
      <h4 class="mb-0">Resultados</h4>
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-striped table-hover align-middle text-center">
          <thead class="table-dark">
            <tr>
              <th>Usuario</th>
              <th>Inicio Turno</th>
              <th>Fin Turno</th>
              <th>Ingresos ($)</th>
              <th>Vehículos Entraron</th>
              <th>Vehículos Salieron</th>
              <th>Vehículos Restantes</th>
              <th class="text-end">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let cierre of cierres">
              <td>{{ cierre.nombreUsuario }}</td>
              <td>{{ cierre.fechaInicioTurno | date:'dd/MM/yy HH:mm' }}</td>
              <td>{{ cierre.fechaFinTurno | date:'dd/MM/yy HH:mm' }}</td>
              <td>{{ cierre.totalIngresos | number }}</td>
              <td>{{ cierre.totalVehiculosEntraron }}</td>
              <td>{{ cierre.totalVehiculosSalieron }}</td>
              <td>{{ cierre.vehiculosRestantes }}</td>
              <td class="text-end">
                <button class="btn btn-sm btn-outline-primary" (click)="imprimirCierre(cierre)" title="Imprimir Cierre">
                  <i class="fas fa-print"></i>
                </button>
              </td>
            </tr>
            <tr *ngIf="cierres.length === 0">
              <td colspan="8" class="text-center fst-italic py-3">No se encontraron registros con los filtros aplicados.</td>
            </tr>
          </tbody>
        </table>
      </div>

      <mat-paginator
        [length]="totalElementos"
        [pageSize]="size"
        [pageIndex]="index"
        [pageSizeOptions]="[5, 10, 20]"
        (page)="cambiarPagina($event)"
        aria-label="Select page"
      >
      </mat-paginator>

    </div>
  </div>
</div>
